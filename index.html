<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ดินแดนศักดิ์สิทธิ์มู่คา: ค้นหาธาตุประจำตัวคุณ</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for Noto Sans Thai -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the game */
        body {
            font-family: 'Noto Sans Thai', sans-serif;
            background-color: #f7fafc; /* Light gray background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
            background: linear-gradient(to bottom right, #e0f2f7, #e8eaf6, #e0f2f7); /* Soft yellowish-greenish-bluish gradient */
        }

        .game-container {
            background-color: #ffffff;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
            padding: 30px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .button-primary {
            background-image: linear-gradient(to right, #6EE7B7, #3B82F6);
            color: white;
            padding: 12px 28px;
            border-radius: 9999px; /* Fully rounded */
            font-weight: bold;
            font-size: 1.125rem; /* text-lg */
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            border: none;
            outline: none;
            margin-top: 20px;
            width: fit-content;
        }

        .button-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            background-image: linear-gradient(to right, #3B82F6, #6EE7B7);
        }

        .button-secondary {
            background-color: #e2e8f0;
            color: #4a5568;
            padding: 10px 24px;
            border-radius: 9999px;
            font-weight: bold;
            font-size: 1rem; /* text-base */
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            outline: none;
            margin-top: 15px;
            width: fit-content;
        }

        .button-secondary:hover {
            background-color: #cbd5e0;
            transform: translateY(-1px);
        }

        .intro-page-content {
            display: none; /* Hidden by default */
        }
        .intro-page-content.active {
            display: block; /* Shown when active */
        }

        /* Specific background for intro pages 0 and 1 */
        .intro-page-0-bg {
            background-image: url('2.jpg'); /* The image from the user */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            padding: 20px; /* Add padding to prevent text from touching edges */
            border-radius: 15px;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.2); /* Subtle inner shadow for depth */
        }
        /* Make sure the image is covering the full page for the intro section */
        #introScreen {
            background-color: transparent; /* Make intro screen background transparent to show image */
        }
        #introPagesContainer {
            background-color: rgba(255, 255, 255, 0.85); /* Slightly transparent white background for text readability */
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        /* Custom color for intro highlights */
        .text-intro-highlight {
            color: #6092b1; /* Custom color as requested, assuming #6092b1 */
        }


        .next-intro-button {
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none; /* Prevents clicks when hidden */
        }
        .next-intro-button.visible {
            opacity: 1;
            pointer-events: auto; /* Allows clicks when visible */
        }

        .question-card {
            background-color: #f0f9ff; /* Light blue background for questions */
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: left;
        }

        .question-text {
            font-size: 1.5rem; /* text-2xl */
            font-weight: bold;
            color: #4a5568; /* Softened color (gray-700) */
            margin-bottom: 20px;
        }

        .answer-option {
            display: flex;
            align-items: center;
            background-color: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .answer-option:hover {
            border-color: #6EE7B7;
            background-color: #f0fdf4; /* Light green hover */
            transform: translateY(-2px);
        }

        .answer-option input[type="radio"] {
            margin-right: 15px;
            transform: scale(1.5); /* Larger radio button */
            accent-color: #3B82F6; /* Blue accent color */
        }

        .answer-option span {
            font-size: 1.125rem; /* text-lg */
            color: #718096; /* Softened color (gray-600) */
        }

        .progress-bar-container {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 10px;
            height: 12px;
            margin-bottom: 25px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: #3B82F6;
            border-radius: 10px;
            transition: width 0.5s ease-in-out;
        }

        /* Result Section Styling */
        .result-section {
            background-color: #ecfdf5; /* Light green background for results */
            border-radius: 15px;
            padding: 25px; /* Reduced padding for compactness */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            gap: 15px; /* Reduced gap between result frames */
        }

        .result-frame {
            background-color: #ffffff;
            border-radius: 15px;
            padding: 20px; /* Reduced padding for compactness */
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .element-title {
            font-size: 2.25rem; /* text-4xl */
            font-weight: bold;
            color: #065F46; /* Dark green - kept for elemental distinction */
            margin-bottom: 15px;
        }

        .element-description {
            font-size: 1rem; /* Slightly reduced for compactness */
            color: #718096; /* Softened color (gray-600) */
            line-height: 1.6; /* Reduced line height */
            text-align: justify;
            margin-bottom: 10px; /* Reduced margin */
        }

        .element-icon-container {
            width: 100px; /* Slightly smaller icon */
            height: 100px; /* Slightly smaller icon */
            background-color: #e0f2f7; /* Light blue background for icon */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px; /* Reduced margin */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .element-icon {
            font-size: 3.5rem; /* Slightly smaller emoji size */
            animation: bounce 2s infinite ease-in-out; /* Basic animation */
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .keywords-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px; /* Reduced gap */
            margin-top: 0px; /* Removed top top margin */
        }

        .keyword-box {
            background-color: #d1fae5; /* Light green - kept for pastel feel */
            color: #065f46; /* Dark green - kept for elemental distinction */
            padding: 6px 12px; /* Reduced padding */
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem; /* Slightly smaller font */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .compatibility-section {
            display: flex;
            flex-direction: column;
            gap: 8px; /* Reduced gap */
            text-align: left;
        }

        .compatibility-item {
            display: flex;
            align-items: flex-start; /* Align icon to top of text */
            gap: 8px; /* Reduced gap */
            font-size: 0.95rem; /* Slightly smaller font */
            color: #718096; /* Softened general compatibility text */
            line-height: 1.4; /* For multi-line descriptions */
        }

        .compatibility-item.positive {
            color: #065f46; /* Green for compatible - kept for distinction */
        }
        .compatibility-item.negative {
            color: #dc2626; /* Red for conflicting - kept for distinction */
        }

        .compatibility-icon {
            font-size: 1.1rem; /* Slightly smaller icon */
            flex-shrink: 0; /* Prevent icon from shrinking */
            margin-top: 2px; /* Adjust vertical alignment */
        }

        .enrollment-link-frame {
            background-color: #e0f2f7; /* Light blue for enrollment frame */
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
            margin-top: 15px; /* Add some margin from previous frame */
        }
        .enrollment-link-frame h4 {
            font-size: 1.8rem;
            font-weight: bold;
            color: #5a7d9f; /* Softened blue */
            margin-bottom: 10px;
        }
        .enrollment-link-frame p {
            font-size: 0.95rem;
            color: #829db7; /* Softened blue-gray */
            margin-bottom: 15px;
        }
        .enrollment-link-frame a {
            display: inline-block;
            background-image: linear-gradient(to right, #3B82F6, #8B5CF6); /* Blue to Purple */
            color: white;
            padding: 10px 24px;
            border-radius: 9999px;
            font-weight: bold;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            text-decoration: none;
        }
        .enrollment-link-frame a:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }


        /* Loading Screen */
        .loading-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 20px;
            min-height: 300px;
        }

        .spinner {
            border: 8px solid #f3f3f3; /* Light grey */
            border-top: 8px solid #3B82F6; /* Blue */
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .game-container {
                padding: 15px; /* More compact on small screens */
            }
            .question-text {
                font-size: 1.15rem; /* text-xl on small screens */
            }
            .answer-option {
                padding: 10px; /* More compact */
            }
            .answer-option span {
                font-size: 0.95rem; /* text-base on small screens */
            }
            .element-title {
                font-size: 1.5rem; /* Smaller for mobile */
            }
            .element-description {
                font-size: 0.9rem; /* Smaller for mobile */
            }
            .element-icon-container {
                width: 80px;
                height: 80px;
            }
            .element-icon {
                font-size: 2.5rem;
            }
            .keyword-box {
                font-size: 0.8rem;
                padding: 5px 10px;
            }
            .compatibility-item {
                font-size: 0.85rem;
            }
            .enrollment-link-frame h4 {
                font-size: 1.5rem;
            }
            .enrollment-link-frame p {
                font-size: 0.85rem;
            }
            .enrollment-link-frame a {
                padding: 8px 20px;
                font-size: 0.9rem;
            }
        }
        /* New style for indented paragraphs in intro */
        .intro-page-content p.indent-text {
            text-indent: 2em; /* Indent the first line by 2 em units */
            text-align: left; /* Keep left-aligned instead of justify */
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-100 via-blue-100 to-purple-100 min-h-screen flex items-center justify-center p-4">
    <div id="gameApp" class="game-container">
        <!-- Introduction Section -->
        <div id="introScreen" class="space-y-6">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-700 mb-4">
                ยินดีต้อนรับสู่ <span class="text-transparent bg-clip-text bg-gradient-to-r from-green-500 to-blue-600">ดินแดนศักดิ์สิทธิ์มู่คา</span>
            </h1>

            <!-- Intro Pages -->
            <div id="introPagesContainer">
                <div class="intro-page-content active intro-page-0-bg" data-page="0">
                    <p class="text-lg text-gray-600 mb-4 indent-text">
                        ณ ดินแดนศักดิ์สิทธิ์ มู่คา (木霞) หุบเขาเวทมนตร์เร้นลับ ที่แสงอรุณแรกจะทอดผ่านยอดไม้ใหญ่เฉพาะยามรุ่งสาง ราวกับสวรรค์ซ่อนอยู่ในโลกมนุษย์ ทุกสรรพสิ่งในผืนแผ่นดินนี้ล้วนดำรงอยู่ด้วย <span class="font-semibold text-intro-highlight">พลังวิญญาณ</span> ซึ่งไหลเวียนเป็นหนึ่งเดียวกับธรรมชาติ
                    </p>
                    <p class="text-lg text-gray-600 mb-4 indent-text">
                        ทุกชีวิตที่ถือกำเนิด ณ แดนนี้ ล้วนผูกพันกับ “ธาตุประจำตัว” ซึ่งสะท้อนจิตวิญญาณแท้จริงในก้นบึ้งของตนเอง ธาตุทั้งสิบได้แก่ <span class="font-semibold text-intro-highlight">ดิน น้ำ ลม ไฟ สายฟ้า แสง ความมืด พฤกษา โลหะ และพลังจิต</span> ธาตุประจำตัวนี้คือแก่นกลางของตัวตน ไม่ว่าใครจะฝึกฝนวิชา ณ สำนักใด ก็ไม่อาจเปลี่ยนแปลงสิ่งนี้ได้
                    </p>
                </div>
                <div class="intro-page-content intro-page-0-bg" data-page="1">
                    <p class="text-lg text-gray-600 mb-4 indent-text">
                        เมื่อกาลเวลาผันผ่าน วิถีเซียนแห่งดินแดนมู่คาได้ผลิดอกออกผล กลายเป็น<span class="font-semibold text-intro-highlight">"สิบสำนักใหญ่"</span> ซึ่งแต่ละสำนักสืบทอดศาสตร์ลึกล้ำแห่งธาตุที่ตนเชี่ยวชาญ สำนักทั้งสิบเป็นดั่งเสาหลักของยุทธภพและเป็นที่พึ่งของผู้แสวงหาพลัง.
                    </p>
                    <p class="text-lg text-gray-600 mb-4 indent-text">
                        ในทุกปีเมื่อยามเดือนเจ็ดมาถึง จะมีการจัด <span class="font-semibold text-intro-highlight">“เทศกาลท้าประลองแห่งยุทธภพ”</span> เพื่อเปิดโอกาสให้เหล่าผู้ฝึกวิชา ไม่ว่าจะศิษย์จากสำนักใหญ่หรือพเนจรจากแดนไกล ก็สมัครเข้าร่วมการประลองด้วยตนเอง หากผ่านการคัดกรองจากเหล่าผู้อาวุโส ก็จะได้รับสิทธิ์เป็น <span class="font-semibold text-intro-highlight">“ผู้แทนแห่งธาตุ”</span> และขึ้นประลองต่อหน้าชาวยุทธภพ เพื่อแสดงให้เห็นว่าพลังแห่งธาตุใดจะส่องประกายที่สุดในห้วงปี.
                    </p>
                </div>
                <div class="intro-page-content" data-page="2">
                    <p class="text-xl font-bold text-black mb-4">
                        ทว่าปีนี้กลับแตกต่างออกไป...
                    </p>
                    <p class="text-xl font-bold text-black mb-4">
                        สายลมแห่งโชคชะตาเริ่มส่งสัญญาณถึงจุดเปลี่ยน
                    </p>
                    <p class="text-xl font-bold text-black mb-4">
                        พลังวิญญาณที่เคยสงบนิ่งในผืนป่าและผืนฟ้าเริ่มสั่นไหว
                    </p>
                    <p class="text-xl font-bold text-black mb-4">
                        ในห้วงยามแห่งความเปลี่ยนแปลง
                    </p>
                    <p class="text-xl font-bold text-black mb-10">
                        ตำนานบทใหม่ ได้เริ่มต้นขึ้นแล้ว!
                    </p>
                </div>
            </div>
            <button id="nextIntroPageButton" class="button-secondary next-intro-button">ต่อไป</button>
            <button id="startButton" class="button-primary hidden">เริ่มต้นการค้นหาธาตุประจำตัวของคุณ</button>
        </div>

        <!-- Quiz Section -->
        <div id="quizScreen" class="hidden w-full">
            <div class="progress-bar-container">
                <div id="progressBar" class="progress-bar"></div>
            </div>
            <div id="questionCard" class="question-card">
                <p id="questionText" class="question-text"></p>
                <div id="answerOptions" class="space-y-3">
                    <!-- Answer options will be injected here by JavaScript -->
                </div>
            </div>
            <button id="nextButton" class="button-primary">ต่อไป</button>
        </div>

        <!-- Loading Screen -->
        <div id="loadingScreen" class="hidden loading-screen">
            <div class="spinner"></div>
            <p class="text-2xl font-bold text-gray-700">กำลังประมวลผลธาตุประจำตัวอันลึกล้ำของคุณ...</p>
        </div>

        <!-- Result Section -->
        <div id="resultScreen" class="hidden w-full result-section">
            <h2 class="text-4xl font-bold text-center mb-6 text-gray-800">
                ธาตุประจำตัวของคุณคือ:
            </h2>

            <!-- Frame 1: Dominant Element & Description -->
            <div class="result-frame">
                <div class="element-icon-container">
                    <span id="elementIcon" class="element-icon"></span>
                </div>
                <h3 id="elementTitle" class="element-title"></h3>
                <p id="elementDescription" class="element-description"></p>
            </div>

            <!-- Frame 2: Keywords -->
            <div class="result-frame">
                <div id="elementKeywords" class="keywords-container">
                    <!-- Keywords will be injected here -->
                </div>
            </div>

            <!-- Frame 3: Compatible & Conflicting Elements -->
            <div class="result-frame">
                <h4 class="text-2xl font-bold text-gray-700 mb-4">ความสัมพันธ์กับธาตุอื่น:</h4>
                <div class="compatibility-section">
                    <div id="compatibleElements">
                        <p class="font-semibold text-green-700 mb-2"><span class="compatibility-icon">✅</span> ธาตุที่เข้ากันได้:</p>
                        <ul id="compatibleList" class="list-disc list-inside text-gray-700">
                            <!-- Compatible elements will be injected here -->
                        </ul>
                    </div>
                    <div id="conflictingElements">
                        <p class="font-semibold text-red-700 mb-2"><span class="compatibility-icon">❌</span> ธาตุที่ขัดแย้ง:</p>
                        <ul id="conflictingList" class="list-disc list-inside text-gray-700">
                            <!-- Conflicting elements will be injected here -->
                        </ul>
                    </div>
                </div>
            </div>

            <!-- New Frame: Enrollment Form Link -->
            <div class="enrollment-link-frame">
                <h4 class="text-2xl md:text-3xl font-extrabold">
                    โชคชะตาแห่งมู่คา... กำลังเรียกหาท่าน!
                </h4>
                <p class="text-base text-gray-700 mt-2 mb-4">
                    เชิญชวนเหล่า MUKA68 เข้าร่วมเทศกาลแห่งการประลอง
                </p>
                <a href="https://forms.gle/3UHbXZ3TiroJhNAR7" target="_blank" class="button-link">
                    สมัครเข้าร่วมค่ายเซียน!
                </a>
            </div>

            <button id="restartButton" class="button-secondary mt-8">เล่นอีกครั้ง</button>
        </div>

        <!-- Custom Alert/Message Box -->
        <div id="messageBox" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
            <div class="bg-white p-8 rounded-lg shadow-xl text-center max-w-sm w-full">
                <p id="messageText" class="text-xl font-semibold text-gray-800 mb-6"></p>
                <button id="closeMessageBox" class="button-primary">ตกลง</button>
            </div>
        </div>
    </div>

    <script>
        // Define elements, their descriptions, keywords, compatible, and conflicting elements
        const elements = {
            "ดิน (Earth)": {
                description: "จากรากฐานแห่งปฐพีอันเป็นนิรันดร์ ผู้มีธาตุดินคือดั่งเสาหลักแห่งความมั่นคง ไม่เคยสั่นคลอนต่อพายุโหมกระหน่ำใดๆ ด้วยความอดทนดุจขุนเขา พวกเขาคือผู้พิทักษ์แห่งสมดุลย์ ผู้สร้างสรรค์ทุกสิ่งจากผืนดินอันอุดม และเป็นผู้นำที่ไม่อาจปฏิเสธได้! พลังแห่งพวกเขาคือแรงโน้มถ่วงที่ดึงดูดทุกสรรพชีวิตให้รวมเป็นหนึ่ง!",
                icon: "🌍", // Changed icon
                keywords: ["มั่นคง", "อดทน", "รากฐาน"],
                compatible: {
                    "โลหะ": "ดินเป็นแหล่งกำเนิดโลหะ ทำให้ธาตุโลหะได้รับความแข็งแกร่งและรูปทรง",
                    "พฤกษา": "ดินหล่อเลี้ยงพฤกษาให้เติบโตอย่างมั่นคง",
                    "น้ำ": "น้ำช่วยให้ดินอ่อนนุ่มและอุดมสมบูรณ์"
                },
                conflicting: {
                    "ลม": "ลมพัดพาดินให้กระจัดกระจายและไร้ทิศทาง",
                    "สายฟ้า": "สายฟ้าผ่าลงมาทำให้ดินแตกแยกและเสียหาย"
                }
            },
            "น้ำ (Water)": {
                description: "จิตวิญญาณแห่งวารี... ผู้ที่ไหลลื่นดุจกระแสน้ำอันไร้ขอบเขต ปรับเปลี่ยนรูปทรงได้ทุกเมื่อแต่ยังคงไว้ซึ่งพลังทำลายล้างที่ไม่อาจหยั่งถึง! พวกเขาคือผู้เยียวยาแห่งโลกใบนี้ ผู้เข้าใจในทุกห้วงอารมณ์ และเป็นผู้พัดพานำพาชีวิตไปสู่การเปลี่ยนแปลงอันยิ่งใหญ่! อย่าได้ดูแคลนความอ่อนโยน เพราะใต้ผิวน้ำนั้นซ่อนเร้นพลังอันมหาศาล!",
                icon: "💧",
                keywords: ["ยืดหยุ่น", "สงบ", "เห็นอกเห็นใจ"],
                compatible: {
                    "พฤกษา": "น้ำเป็นสิ่งจำเป็นต่อการเจริญเติบโตของพฤกษา",
                    "ลม": "ลมช่วยพัดพาน้ำ ทำให้เกิดเมฆและฝน",
                    "ดิน": "น้ำช่วยให้ดินอ่อนนุ่มและอุดมสมบูรณ์"
                },
                conflicting: {
                    "ไฟ": "น้ำดับไฟ ทำให้พลังแห่งไฟมอดลง",
                    "สายฟ้า": "น้ำเป็นสื่อนำไฟฟ้า ทำให้สายฟ้ามีพลังทำลายรุนแรงขึ้นเมื่อสัมผัส"
                }
            },
            "ลม (Wind)": {
                description: "โบยบินอย่างอิสระดุจสายลมแห่งทวยเทพ! ผู้มีธาตุลมคือผู้ปลดปล่อยแห่งการเปลี่ยนแปลง ผู้ซึ่งความคิดสร้างสรรค์ทะลุขอบฟ้า และไม่เคยหยุดนิ่งในเส้นทางใด! พวกเขาคือผู้ส่งสารแห่งโชคชะตา ผู้ปลุกปั่นพายุแห่งการปฏิวัติ ที่จะพัดพาทุกสิ่งให้ก้าวข้ามสู่ยุคใหม่! อย่าพยายามจับต้องพวกเขา เพราะพวกเขาจะหายไปในพริบตา!",
                icon: "🌪️", // Changed icon
                keywords: ["อิสระ", "สร้างสรรค์", "เปลี่ยนแปลง"],
                compatible: {
                    "ไฟ": "ลมช่วยโหมกระหน่ำไฟให้ลุกโชนยิ่งขึ้น",
                    "สายฟ้า": "ลมช่วยพัดพากระแสสายฟ้า ทำให้พลังทำลายรุนแรงขึ้น",
                    "น้ำ": "ลมช่วยพัดพาน้ำ ทำให้เกิดเมฆและฝน"
                },
                conflicting: {
                    "ดิน": "ลมพัดพาดินให้กระจัดกระจายและไร้ทิศทาง",
                    "โลหะ": "ลมไม่สามารถส่งผลกระทบต่อโลหะได้โดยตรง ทำให้เกิดความเฉยเมย"
                }
            },
            "ไฟ (Fire)": {
                description: "เปลวเพลิงอันโชติช่วง! ผู้มีธาตุไฟคือผู้ที่เต็มเปี่ยมด้วยความมุ่งมั่นอันเร่าร้อนราวลาวาจากใจกลางพิภพ ความหลงใหลที่เผาผลาญทุกอุปสรรค และพลังงานอันล้นเหลือที่จะจุดประกายโลกทั้งใบ! พวกเขาคือผู้กล้าหาญที่นำทางความมืดมิด เป็นแรงบันดาลใจที่ไม่มีวันมอดดับ! ผู้ใดขวางทางพวกเขา ผู้นั้นจะมอดไหม้เป็นเถ้าธุลี!",
                icon: "🔥",
                keywords: ["มุ่งมั่น", "หลงใหล", "กล้าหาญ"],
                compatible: {
                    "ลม": "ลมช่วยโหมกระหน่ำไฟให้ลุกโชนยิ่งขึ้น",
                    "สายฟ้า": "ไฟและสายฟ้าเป็นพลังงานบริสุทธิ์ที่ส่งเสริมกัน",
                    "แสง": "ไฟเป็นแหล่งกำเนิดแสง ทำให้แสงสว่างไสวขึ้น"
                },
                conflicting: {
                    "น้ำ": "น้ำดับไฟ ทำให้พลังแห่งไฟมอดลง",
                    "ดิน": "ดินสามารถกักเก็บหรือกลบไฟให้มอดดับได้"
                }
            },
            "สายฟ้า (Lightning)": {
                description: "อัสนีบาตแห่งสวรรค์! ผู้มีธาตุสายฟ้าคือผู้ที่มีความรวดเร็วดุจอัสนีบาต เฉียบคมราวคมดาบแห่งเทพ และการตัดสินใจที่เด็ดขาดราวฟ้าผ่า! พวกเขานำมาซึ่งการเปลี่ยนแปลงอย่างฉับพลัน เป็นพลังทั้งในการทำลายล้างเพื่อสร้างสรรค์ และการนำทางด้วยวิสัยทัศน์ที่ก้าวไกลเกินกว่าใครจะหยั่งถึง! ผู้ใดขัดขวาง ย่อมต้องพบกับหายนะสายฟ้า!",
                icon: "⚡",
                keywords: ["รวดเร็ว", "เฉียบคม", "เด็ดขาด"],
                compatible: {
                    "ลม": "ลมช่วยพัดพากระแสสายฟ้า ทำให้พลังทำลายรุนแรงขึ้น",
                    "ไฟ": "ไฟและสายฟ้าเป็นพลังงานบริสุทธิ์ที่ส่งเสริมกัน",
                    "โลหะ": "โลหะเป็นสื่อนำไฟฟ้าที่ดี ทำให้พลังสายฟ้าไหลผ่านได้อย่างทรงพลัง"
                },
                conflicting: {
                    "ดิน": "ดินสามารถดูดซับพลังงานสายฟ้า ทำให้สายฟ้าอ่อนกำลังลง",
                    "น้ำ": "น้ำเป็นสื่อนำไฟฟ้า ทำให้สายฟ้ามีพลังทำลายรุนแรงขึ้นเมื่อสัมผัส (ในทางกลับกันก็เป็นอันตรายต่อผู้ใช้เช่นกัน)"
                }
            },
            "แสง (Light)": {
                description: "แสงสว่างอันบริสุทธิ์ดุจดวงอาทิตย์! ผู้มีธาตุแสงคือผู้ที่เปี่ยมด้วยสติปัญญาอันไร้ขีดจำกัด และความหวังที่ส่องสว่างนำทางในความมืดมิด! พวกเขาคือผู้เยียวยาแห่งโลก ผู้เปิดเผยความจริงอันเป็นนิรันดร์! ไม่มีเงามืดใดจะหลบซ่อนจากสายตาแห่งแสงอันบริสุทธิ์ของพวกเขาได้!",
                icon: "✨",
                keywords: ["สติปัญญา", "ความหวัง", "ยุติธรรม"],
                compatible: {
                    "พลังจิต": "แสงช่วยเสริมสร้างการหยั่งรู้และพลังจิตให้ชัดเจนยิ่งขึ้น",
                    "พฤกษา": "แสงเป็นสิ่งจำเป็นต่อการเจริญเติบโตของพฤกษา",
                    "ไฟ": "ไฟเป็นแหล่งกำเนิดแสง ทำให้แสงสว่างไสวขึ้น"
                },
                conflicting: {
                    "ความมืด": "แสงและความมืดเป็นขั้วตรงข้ามที่คอยหักล้างกัน"
                }
            },
            "ความมืด (Darkness)": {
                description: "ห้วงรัตติกาลอันลึกล้ำ... ผู้มีธาตุความมืดคือผู้ที่มีความลึกลับดุจจักรวาลอันไร้สิ้นสุด มีสัญชาตญาณที่เฉียบคม และมักจะเป็นผู้เฝ้ามองจากเบื้องหลัง พวกเขามีพลังแห่งการเปลี่ยนแปลงที่ซ่อนเร้น สามารถมองเห็นสิ่งที่ผู้อื่นไม่อาจเห็น เป็นจิตวิญญาณแห่งเงาที่ทรงพลังและไม่อาจคาดเดาได้!",
                icon: "🌑",
                keywords: ["ลึกลับ", "สัญชาตญาณ", "ซับซ้อน"],
                compatible: {
                    "พลังจิต": "ความมืดช่วยเสริมสร้างสัญชาตญาณและพลังจิตในด้านการหยั่งรู้",
                    "น้ำ": "ความมืดช่วยปกป้องน้ำจากการระเหยและสร้างบรรยากาศลึกลับ",
                    "ดิน": "ความมืดทำให้ดินสงบและเป็นแหล่งซ่อนเร้น"
                },
                conflicting: {
                    "แสง": "แสงและความมืดเป็นขั้วตรงข้ามที่คอยหักล้างกัน",
                    "ไฟ": "ไฟเผาผลาญความมืดให้จางหายไป"
                }
            },
            "พฤกษา (Nature)": {
                description: "จิตวิญญาณแห่งผืนป่าอันยิ่งใหญ่! ผู้มีธาตุพฤกษาคือผู้ที่สื่อถึงการเติบโตอันไม่สิ้นสุด ความอุดมสมบูรณ์ราวป่าศักดิ์สิทธิ์ และการเชื่อมโยงกับทุกสิ่งมีชีวิต! พวกเขาเป็นผู้มีเมตตาที่หล่อเลี้ยงทุกสรรพสิ่ง และเป็นพลังแห่งการฟื้นฟูที่สามารถเยียวยาบาดแผลของโลกใบนี้ได้! ชีวิตและความตายอยู่ในกำมือของพวกเขา!",
                icon: "🍃", // Changed icon
                keywords: ["เติบโต", "เมตตา", "ชีวิตชีวา"],
                compatible: {
                    "ดิน": "ดินหล่อเลี้ยงพฤกษาให้เติบโตอย่างมั่นคง",
                    "น้ำ": "น้ำเป็นสิ่งจำเป็นต่อการเจริญเติบโตของพฤกษา",
                    "แสง": "แสงเป็นสิ่งจำเป็นต่อการเจริญเติบโตของพฤกษา"
                },
                conflicting: {
                    "ไฟ": "ไฟเผาผลาญพฤกษาให้มอดไหม้",
                    "โลหะ": "โลหะสามารถตัดโค่นพฤกษาได้"
                }
            },
            "โลหะ (Metal)": {
                description: "พลังแห่งโลหะกล้า! ผู้มีธาตุโลหะคือผู้ที่มีความแข็งแกร่งดุจภูผาเหล็กกล้า ความแม่นยำราวคมมีดแห่งความยุติธรรม และความเด็ดขาดที่ไม่มีใครเทียบได้ พวกเขามีวินัยสูงสุด เป็นผู้ปกป้องอันทรงพลัง และยึดมั่นในหลักการอย่างไม่สั่นคลอน! ผู้ใดต่อต้าน ย่อมต้องเผชิญหน้ากับคมดาบที่ไร้ปรานี!",
                icon: "🗡️", // Changed icon
                keywords: ["แข็งแกร่ง", "แม่นยำ", "มีวินัย"],
                compatible: {
                    "ดิน": "ดินเป็นแหล่งกำเนิดโลหะ ทำให้ธาตุโลหะได้รับความแข็งแกร่งและรูปทรง",
                    "สายฟ้า": "โลหะเป็นสื่อนำไฟฟ้าที่ดี ทำให้พลังสายฟ้าไหลผ่านได้อย่างทรงพลัง"
                },
                conflicting: {
                    "ไฟ": "ไฟหลอมละลายโลหะ ทำให้สูญเสียรูปร่างและความแข็งแกร่ง",
                    "น้ำ": "น้ำสามารถทำให้โลหะเกิดสนิมและผุกร่อนได้"
                }
            },
            "พลังจิต (Psychic)": {
                description: "ดวงตาแห่งเทพ! ผู้มีธาตุพลังจิตคือผู้ที่มีการหยั่งรู้สูงดุจดวงตาแห่งเทพ มีพลังความคิดที่สร้างสรรค์ และความเข้าใจในสัจธรรมอันลึกล้ำ พวกเขาสามารถเชื่อมโยงกับสิ่งเหนือธรรมชาติและมองเห็นความจริงที่ซ่อนอยู่ เป็นพลังแห่งจิตวิญญาณที่ไร้ขีดจำกัด!",
                icon: "🧠",
                keywords: ["หยั่งรู้", "ความคิดสร้างสรรค์", "สัจธรรม"],
                compatible: {
                    "แสง": "แสงช่วยเสริมสร้างการหยั่งรู้และพลังจิตให้ชัดเจนยิ่งขึ้น",
                    "ความมืด": "ความมืดช่วยเสริมสร้างสัญชาตญาณและพลังจิตในด้านการหยั่งรู้"
                },
                conflicting: {
                    "โลหะ": "โลหะที่บริสุทธิ์และแข็งแกร่งสามารถสกัดกั้นพลังจิตได้",
                    "ดิน": "ดินมีความหนักแน่นและมั่นคง ทำให้พลังจิตยากที่จะแทรกซึม"
                }
            }
        };

        // Quiz questions and their scoring
        const questions = [
            {
                question: "คุณจะตอบสนองอย่างไรเมื่อตำนานโบราณถูกปลุกให้ตื่นขึ้น และพลังวิญญาณเริ่มแปรปรวน?",
                options: [
                    { text: "วิเคราะห์สถานการณ์และวางแผนรับมืออย่างรอบคอบ", scores: { "ดิน": 1, "แสง": 1, "โลหะ": 1 } },
                    { text: "พุ่งเข้าสู่ใจกลางความปั่นป่วนด้วยความกล้าหาญ", scores: { "ไฟ": 1, "สายฟ้า": 1 } },
                    { text: "ปรับตัวตามกระแสพลัง ค้นหาสมดุลใหม่", scores: { "น้ำ": 1, "ลม": 1, "พฤกษา": 1 } },
                    { text: "ซุ่มสังเกตการณ์จากเงามืด รอจังหวะที่เหมาะสม", scores: { "ความมืด": 1, "พลังจิต": 1 } }
                ]
            },
            {
                question: "ในยามที่โลกมู่คาเข้าสู่จุดเปลี่ยน คุณจะใช้เวลาว่างไปกับสิ่งใด?",
                options: [
                    { text: "บำเพ็ญเพียรและขัดเกลาจิตวิญญาณให้บริสุทธิ์", scores: { "แสง": 1, "พลังจิต": 1, "ความมืด": 1 } },
                    { text: "ออกสำรวจดินแดนที่เปลี่ยนแปลงไป ค้นหาความลับ", scores: { "ไฟ": 1, "สายฟ้า": 1, "ลม": 1 } },
                    { text: "ฟื้นฟูธรรมชาติ หรือทำสมาธิในป่าลึก", scores: { "พฤกษา": 1, "ดิน": 1, "น้ำ": 1 } },
                    { text: "หลอมสร้างอาวุธหรืออุปกรณ์เวทมนตร์ใหม่", scores: { "โลหะ": 1, "ลม": 1, "ไฟ": 1 } }
                ]
            },
            {
                question: "สิ่งใดที่คุณยึดมั่นถือมั่นมากที่สุดในเส้นทางแห่งเซียน?",
                options: [
                    { text: "ความมั่นคงของสำนักและรากฐานที่แข็งแกร่ง", scores: { "ดิน": 1, "โลหะ": 1 } },
                    { text: "การพัฒนาตนเองสู่จุดสูงสุด และการหยั่งรู้ถึงแก่นแท้ด้วยปัญญา", scores: { "พฤกษา": 1, "แสง": 1, "พลังจิต": 1, "ความมืด": 1 } }, // Merged option
                    { text: "อิสระในการแสวงหาสัจธรรม และความสามารถในการปรับเปลี่ยน", scores: { "ลม": 1, "น้ำ": 1 } },
                    { text: "การสร้างตำนานอันยิ่งใหญ่ที่จะถูกจดจำไปชั่วกาล", scores: { "ไฟ": 1, "สายฟ้า": 1 } }
                ]
            },
            {
                question: "เมื่อมิตรสหายแห่งเซียนตกอยู่ในอันตราย คุณจะตอบสนองอย่างไร?",
                options: [
                    { text: "ค้นหาสาเหตุและวางแผนช่วยอย่างรอบคอบ", scores: { "แสง": 1, "พลังจิต": 1, "ดิน": 1 } },
                    { text: "พุ่งทะยานเข้าช่วยเหลือด้วยพลังทั้งหมด", scores: { "ไฟ": 1, "สายฟ้า": 1 } },
                    { text: "เข้าประชิดตัวอย่างนุ่มนวล หลบหลีกการโจมตี และพยุงมิตรออกมา", scores: { "น้ำ": 1, "พฤกษา": 1 } },
                    { text: "ใช้พลังอำนาจที่เฉียบคม จัดการภัยคุกคามให้สิ้นซาก", scores: { "โลหะ": 1, "ความมืด": 1 } }
                ]
            },
            {
                question: "คุณรับมือกับการเปลี่ยนแปลงที่ไม่คาดฝันในวิถีเซียนอย่างไร?",
                options: [
                    { text: "ปรับตัวตามกระแสโชคชะตา ค้นหาสิ่งใหม่ๆ", scores: { "น้ำ": 1, "ลม": 1, "พฤกษา": 1 } },
                    { text: "ยึดมั่นในวิถีเดิม เสริมสร้างความแข็งแกร่งภายใน", scores: { "ดิน": 1, "โลหะ": 1 } },
                    { text: "มองว่านี่คือการท้าทาย และโอกาสในการปลดปล่อยพลังที่แท้จริง", scores: { "ไฟ": 1, "สายฟ้า": 1 } },
                    { text: "มองเห็นนิมิตหมายหรือความหมายที่ซ่อนอยู่เบื้องหลัง", scores: { "แสง": 1, "ความมืด": 1, "พลังจิต": 1 } }
                ]
            },
            {
                question: "ในการรวมพลังเพื่อเผชิญหน้ากับภัยคุกคาม คุณมีบทบาทแบบใดมากที่สุด?",
                options: [
                    { text: "เป็นแกนหลักในการจัดระเบียบทัพและวางกลยุทธ์", scores: { "ดิน": 1, "โลหะ": 1 } },
                    { text: "เป็นผู้จุดประกายความหวังและกระตุ้นขวัญกำลังใจ", scores: { "ไฟ": 1, "สายฟ้า": 1 } },
                    { text: "เป็นผู้เชื่อมโยงจิตใจของทุกคน และนำพาสู่ความสามัคคี", scores: { "น้ำ": 1, "ลม": 1 } },
                    { text: "เป็นผู้หยั่งรู้ถึงจุดอ่อนศัตรู และกำหนดทิศทางพิชิต", scores: { "แสง": 1, "พลังจิต": 1 } }
                ]
            },
            {
                question: "สถานที่ใดในดินแดนมู่คาที่ทำให้คุณรู้สึกเชื่อมโยงกับพลังวิญญาณมากที่สุด?",
                options: [
                    { text: "ยอดเขาลึกลับ หรือวิหารโบราณอันเงียบสงบ", scores: { "แสง": 1, "พลังจิต": 1, "ความมืด": 1 } },
                    { text: "ป่าทึบ หรือน้ำตกที่ซ่อนอยู่ในหุบเหว", scores: { "พฤกษา": 1, "น้ำ": 1, "ดิน": 1 } },
                    { text: "ลานประลองที่กึกก้อง หรือท้องฟ้าที่เต็มไปด้วยเมฆฝนคำราม", scores: { "ลม": 1, "ไฟ": 1, "สายฟ้า": 1 } },
                    { text: "ห้องคลังศิลาเวท หรือโรงหลอมที่เต็มไปด้วยประกายไฟ", scores: { "โลหะ": 1, "ไฟ": 1 } }
                ]
            },
            {
                question: "คุณมีปฏิกิริยาอย่างไรเมื่อเผชิญหน้ากับการทรยศหักหลังในหมู่เซียน?",
                options: [
                    { text: "พยายามทำความเข้าใจแรงจูงใจ และแสวงหาสัจธรรม", scores: { "แสง": 1, "พลังจิต": 1 } },
                    { text: "ตอบโต้ด้วยความรวดเร็วและเด็ดขาด ปกป้องความยุติธรรม", scores: { "ไฟ": 1, "สายฟ้า": 1, "โลหะ": 1 } },
                    { text: "โอบรับความเจ็บปวด และเยียวยาบาดแผลในจิตใจ", scores: { "น้ำ": 1, "พฤกษา": 1 } },
                    { text: "เก็บงำความโกรธไว้ในเงามืด รอเวลาที่เหมาะสม", scores: { "ความมืด": 1, "ดิน": 1 } }
                ]
            },
            {
                question: "หากคุณสามารถควบคุมพลังวิญญาณแห่งธาตุได้ คุณอยากให้มันเกี่ยวกับอะไร?",
                options: [
                    { text: "ควบคุมสรรพชีวิตและธรรมชาติให้เติบโตงดงาม", scores: { "พฤกษา": 1, "ดิน": 1, "น้ำ": 1 } },
                    { text: "ควบคุมมิติเวลาและห้วงอวกาศเพื่อมองเห็นอนาคต", scores: { "พลังจิต": 1, "แสง": 1, "ความมืด": 1 } },
                    { text: "ปลดปล่อยพลังทำลายล้างที่สามารถเปลี่ยนแปลงโลก", scores: { "ไฟ": 1, "สายฟ้า": 1, "โลหะ": 1 } },
                    { text: "เคลื่อนที่ไปในทุกหนแห่งได้อย่างอิสระและรวดเร็ว", scores: { "ลม": 1, "สายฟ้า": 1 } }
                ]
            }
        ];

        let currentIntroPageIndex = 0;
        let currentQuestionIndex = 0;
        let scores = {}; // To store scores for each element
        const allElements = Object.keys(elements); // Get all element names

        // Initialize scores to 0 for all elements
        allElements.forEach(element => {
            scores[element] = 0;
        });

        // Get DOM elements
        const introScreen = document.getElementById('introScreen');
        const introPagesContainer = document.getElementById('introPagesContainer');
        const introPages = document.querySelectorAll('.intro-page-content');
        const nextIntroPageButton = document.getElementById('nextIntroPageButton');

        const quizScreen = document.getElementById('quizScreen');
        const progressBar = document.getElementById('progressBar');
        const questionText = document.getElementById('questionText');
        const answerOptionsDiv = document.getElementById('answerOptions');
        const nextButton = document.getElementById('nextButton');

        const loadingScreen = document.getElementById('loadingScreen');

        const resultScreen = document.getElementById('resultScreen');
        const elementIcon = document.getElementById('elementIcon');
        const elementTitle = document.getElementById('elementTitle');
        const elementDescription = document.getElementById('elementDescription');
        const elementKeywordsDiv = document.getElementById('elementKeywords');
        const compatibleList = document.getElementById('compatibleList');
        const conflictingList = document.getElementById('conflictingList');
        const restartButton = document.getElementById('restartButton');

        const messageBox = document.getElementById('messageBox');
        const messageText = document.getElementById('messageText');
        const closeMessageBox = document.getElementById('closeMessageBox');
        const startButton = document.getElementById('startButton'); // The original start button, now hidden until last intro page

        /**
         * Shows a custom message box.
         * @param {string} message - The message to display.
         */
        function showMessageBox(message) {
            messageText.textContent = message;
            messageBox.classList.remove('hidden');
        }

        /**
         * Hides the custom message box.
         */
        function hideMessageBox() {
            messageBox.classList.add('hidden');
        }

        closeMessageBox.addEventListener('click', hideMessageBox);

        /**
         * Displays the current introduction page.
         */
        function displayIntroPage() {
            introPages.forEach((page, index) => {
                if (index === currentIntroPageIndex) {
                    page.classList.add('active');
                    // Add background class for pages 0 and 1
                    if (index === 0 || index === 1) {
                        page.classList.add('intro-page-0-bg');
                    } else {
                        page.classList.remove('intro-page-0-bg');
                    }
                } else {
                    page.classList.remove('active');
                }
            });

            // Show or hide buttons based on current page
            if (currentIntroPageIndex < introPages.length - 1) {
                nextIntroPageButton.classList.add('visible');
                nextIntroPageButton.classList.remove('hidden');
                startButton.classList.add('hidden'); // Hide actual start button
            } else {
                nextIntroPageButton.classList.remove('visible');
                nextIntroPageButton.classList.add('hidden');
                startButton.classList.remove('hidden'); // Show actual start button on last page
            }
        }

        /**
         * Updates the progress bar based on the current question index.
         */
        function updateProgressBar() {
            const progress = (currentQuestionIndex / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        /**
         * Displays the current question and its answer options.
         */
        function displayQuestion() {
            const q = questions[currentQuestionIndex];
            questionText.textContent = `${currentQuestionIndex + 1}. ${q.question}`;
            answerOptionsDiv.innerHTML = ''; // Clear previous options

            q.options.forEach((option, index) => {
                const label = document.createElement('label');
                label.className = 'answer-option';
                label.innerHTML = `
                    <input type="radio" name="answer" value="${index}" class="form-radio">
                    <span>${option.text}</span>
                `;
                answerOptionsDiv.appendChild(label);

                // Add event listener to change style on selection
                const radioInput = label.querySelector('input[type="radio"]');
                radioInput.addEventListener('change', () => {
                    // Remove selected style from all options
                    answerOptionsDiv.querySelectorAll('.answer-option').forEach(opt => {
                        opt.classList.remove('border-green-500', 'bg-green-50', 'shadow-md');
                    });
                    // Add selected style to the chosen option
                    if (radioInput.checked) {
                        label.classList.add('border-green-500', 'bg-green-50', 'shadow-md');
                    }
                });
            });
            updateProgressBar();
        }

        /**
         * Handles the "Next" button click.
         * Calculates scores based on the selected answer and moves to the next question or results.
         */
        function handleNextQuestion() {
            const selectedOption = document.querySelector('input[name="answer"]:checked');
            if (!selectedOption) {
                showMessageBox("กรุณาเลือกคำตอบก่อนกด 'ต่อไป'");
                return;
            }

            const selectedOptionIndex = parseInt(selectedOption.value);
            const currentQuestion = questions[currentQuestionIndex];
            const selectedAnswerScores = currentQuestion.options[selectedOptionIndex].scores;

            // Add scores to each element
            for (const element in selectedAnswerScores) {
                if (scores.hasOwnProperty(element)) {
                    scores[element] += selectedAnswerScores[element];
                }
            }

            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                displayQuestion();
            } else {
                // All questions answered, show loading screen then result
                quizScreen.classList.add('hidden');
                loadingScreen.classList.remove('hidden');
                setTimeout(showResult, 2000); // Simulate loading for 2 seconds
            }
        }

        /**
         * Determines the dominant element and displays the result screen.
         */
        function showResult() {
            loadingScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');

            let maxScore = -1;
            let dominantElement = '';

            // Find the element with the highest score
            for (const element in scores) {
                if (scores[element] > maxScore) {
                    maxScore = scores[element];
                    dominantElement = element;
                }
            }

            const possibleDominantElements = [];
            for (const element in scores) {
                if (scores[element] === maxScore) {
                    possibleDominantElements.push(element);
                }
            }
            if (possibleDominantElements.length > 1) {
                dominantElement = possibleDominantElements[Math.floor(Math.random() * possibleDominantElements.length)];
            }

            // Display the result
            const resultElement = elements[dominantElement];
            elementTitle.textContent = dominantElement;
            elementDescription.textContent = resultElement.description;
            elementIcon.textContent = resultElement.icon; // Set emoji icon

            // Display keywords
            elementKeywordsDiv.innerHTML = '';
            resultElement.keywords.forEach(keyword => {
                const span = document.createElement('span');
                span.className = 'keyword-box';
                span.textContent = keyword;
                elementKeywordsDiv.appendChild(span);
            });

            // Display compatible elements
            compatibleList.innerHTML = '';
            if (resultElement.compatible) {
                for (const compElement in resultElement.compatible) {
                    const li = document.createElement('li');
                    li.className = 'compatibility-item positive';
                    li.innerHTML = `<span class="compatibility-icon">✅</span> <strong>${compElement}:</strong> ${resultElement.compatible[compElement]}`;
                    compatibleList.appendChild(li);
                }
            } else {
                const li = document.createElement('li');
                li.className = 'compatibility-item';
                li.textContent = "ไม่มีข้อมูลธาตุที่เข้ากันได้";
                compatibleList.appendChild(li);
            }

            // Display conflicting elements
            conflictingList.innerHTML = '';
            if (resultElement.conflicting) {
                for (const confElement in resultElement.conflicting) {
                    const li = document.createElement('li');
                    li.className = 'compatibility-item negative';
                    li.innerHTML = `<span class="compatibility-icon">❌</span> <strong>${confElement}:</strong> ${resultElement.conflicting[confElement]}`;
                    conflictingList.appendChild(li);
                }
            } else {
                const li = document.createElement('li');
                li.className = 'compatibility-item';
                li.textContent = "ไม่มีข้อมูลธาตุที่ขัดแย้ง";
                conflictingList.appendChild(li);
            }
        }

        /**
         * Resets the game to its initial state.
         */
        function resetGame() {
            currentIntroPageIndex = 0;
            currentQuestionIndex = 0;
            allElements.forEach(element => {
                scores[element] = 0;
            });
            // Hide all screens, show intro
            resultScreen.classList.add('hidden');
            quizScreen.classList.add('hidden');
            loadingScreen.classList.add('hidden');
            introScreen.classList.remove('hidden');
            displayIntroPage(); // Reset intro page display
            updateProgressBar(); // Reset progress bar
        }

        // Event Listeners
        nextIntroPageButton.addEventListener('click', () => {
            currentIntroPageIndex++;
            if (currentIntroPageIndex < introPages.length) {
                displayIntroPage();
            }
        });

        startButton.addEventListener('click', () => {
            introScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            displayQuestion();
        });

        nextButton.addEventListener('click', handleNextQuestion);
        restartButton.addEventListener('click', resetGame);

        // Initial setup on window load
        window.onload = function() {
            // Ensure intro screen is visible initially
            resetGame(); // Call resetGame to set initial state correctly
        };
    </script>
</body>
</html>
